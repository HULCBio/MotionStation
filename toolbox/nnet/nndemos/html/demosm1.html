<!--
This HTML is auto-generated from an m-file.
Your changes will be overwritten.
--><p xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd" style="color:#990000; font-weight:bold; font-size:x-large">A One-dimensional Self-organizing Map</p><p xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd">Neurons in a 2-D layer learn to represent different regions of the input space
where input vectors occur.  In addition, neighboring neurons learn to respond
to similar inputs, thus the layer learns the topology of the presented input
space.
</p><p xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd">Copyright 1992-2002 The MathWorks, Inc.
$Revision: 1.20 $  $Date: 2002/03/29 19:36:03 $
</p><p xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd" style="color:#990000; font-weight:bold; font-size:medium; page-break-before: auto;"><a name=""></a></p><p xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd">Here 100 data points are created on the unit circle.
</p><p xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd">A competitive network will be used to classify these points into natural
classes.
</p><pre xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd" style="position: relative; left:30px">angles = 0:0.5*pi/99:0.5*pi;
P = [sin(angles); cos(angles)];
plot(P(1,:),P(2,:),<span style="color:#B20000">'+r'</span>)</pre><img xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd" src="demosm1_img02.gif"><p xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd" style="color:#990000; font-weight:bold; font-size:medium; page-break-before: auto;"><a name=""></a></p><p xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd">The map will be a 1-dimensional layer of 10 neurons.
</p><p xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd">The first argument specifies two inputs, each with a range of 0 to 1.  The
second determines the network is one dimensional with 10 neurons.
</p><pre xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd" style="position: relative; left:30px">net = newsom([0 1;0 1],[10]);</pre><p xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd" style="color:#990000; font-weight:bold; font-size:medium; page-break-before: auto;"><a name=""></a></p><p xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd">Specify the network is to be trained for 10 epochs and use TRAIN to train the
network on the input data P:
</p><pre xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd" style="position: relative; left:30px">net.trainParam.epochs = 10;
net = train(net,P);</pre><pre xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd" style="color:gray; font-style:italic;">TRAINR, Epoch 0/10
TRAINR, Epoch 10/10
TRAINR, Maximum epoch reached.

</pre><p xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd" style="color:#990000; font-weight:bold; font-size:medium; page-break-before: auto;"><a name=""></a></p><p xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd">Now plot the trained network with PLOTSOM.
</p><p xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd">The red dots are the neuron's weight vectors, and the blue lines connect each
pair within a distance of 1.
</p><pre xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd" style="position: relative; left:30px">plotsom(net.iw{1,1},net.layers{1}.distances)</pre><img xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd" src="demosm1_img05.gif"><p xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd" style="color:#990000; font-weight:bold; font-size:medium; page-break-before: auto;"><a name=""></a></p><p xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd">The map can now be used to classify inputs, like [1; 0]:
</p><p xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd">Either neuron 1 or 10 should have an output of 1, as the above input vector
was at one end of the presented input space.  The first pair of numbers
indicate the neuron, and the single number indicates its output.
</p><pre xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd" style="position: relative; left:30px">p = [1;0];
a = sim(net,p)</pre><pre xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd" style="color:gray; font-style:italic;">
a =

   (1,1)        1

</pre><originalCode xmlns:mwsh="http://www.mathworks.com/namespace/mcode/v1/syntaxhighlight.dtd" code="%% A One-dimensional Self-organizing Map&#xA;% Neurons in a 2-D layer learn to represent different regions of the input space&#xA;% where input vectors occur.  In addition, neighboring neurons learn to respond&#xA;% to similar inputs, thus the layer learns the topology of the presented input&#xA;% space.&#xA;%&#xA;% Copyright 1992-2002 The MathWorks, Inc.&#xA;% $Revision: 1.20 $  $Date: 2002/03/29 19:36:03 $&#xA;&#xA;%%&#xA;% Here 100 data points are created on the unit circle.&#xA;%&#xA;% A competitive network will be used to classify these points into natural&#xA;% classes.&#xA;&#xA;angles = 0:0.5*pi/99:0.5*pi;&#xA;P = [sin(angles); cos(angles)];&#xA;plot(P(1,:),P(2,:),'+r')&#xA;&#xA;%%&#xA;% The map will be a 1-dimensional layer of 10 neurons.&#xA;%&#xA;% The first argument specifies two inputs, each with a range of 0 to 1.  The&#xA;% second determines the network is one dimensional with 10 neurons.&#xA;&#xA;net = newsom([0 1;0 1],[10]);&#xA;&#xA;%%&#xA;% Specify the network is to be trained for 10 epochs and use TRAIN to train the&#xA;% network on the input data P:&#xA;&#xA;net.trainParam.epochs = 10;&#xA;net = train(net,P);&#xA;&#xA;%%&#xA;% Now plot the trained network with PLOTSOM.&#xA;% &#xA;% The red dots are the neuron's weight vectors, and the blue lines connect each&#xA;% pair within a distance of 1.&#xA;&#xA;plotsom(net.iw{1,1},net.layers{1}.distances)&#xA;&#xA;%%&#xA;% The map can now be used to classify inputs, like [1; 0]:&#xA;%&#xA;% Either neuron 1 or 10 should have an output of 1, as the above input vector&#xA;% was at one end of the presented input space.  The first pair of numbers&#xA;% indicate the neuron, and the single number indicates its output.&#xA;&#xA;p = [1;0];&#xA;a = sim(net,p)&#xA;"></originalCode>