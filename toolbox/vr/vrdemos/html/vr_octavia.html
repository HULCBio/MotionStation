<html>
<!-- $Revision: 1.1.6.1 $  $Date: 2004/03/30 13:18:42 $  $Author: batserve $ -->
<head><title>Virtual Reality Toolbox Demo: vr_octavia</title></head>
<body>

<p style="color:#990000; font-weight:bold; font-size:x-large">Vehicle Dynamics Visualization</p>

<p>
The <code><strong>vr_octavia</strong></code> example shows the benefits of visualization of 
complex dynamic model in the virtual reality environment. It also demonstrates Virtual Reality Toolbox 
<strong>3D off-line animation recording functionality</strong>.
</p>

<p>
The pre-computed simulation data, representing one lap of a vehicle on a testing circuit,
is converted from dynamic model signal structure into the form that can be sent to the virtual reality scene.
This conversion includes splitting the combined signals into signals governing individual VRML objects
properties and coordinate systems transformations. The data is then sent to the virtual reality scene
using <strong>VR Sink</strong> block with sample rate 25 Hz.
</p>

<p>
The dynamic model provides not only signals that influence visual properties of objects 
(positions and rotations), but also forces and other similar quantities, that can be visualized as well. 
In this example, wheel forces are visualized using VRML triads scaled dynamically according 
to current force values. Force triads can be switched off by the Forces Visibility Switch.
</p>

<p>
Virtual Reality Toolbox allows two methods of recording animation files - 2D animation (AVI files) and 3D
animation (VRML files). Here we describe how a 3D VRML animation file can be created and further used.
In the internal viewer Recording menu select the <strong>Recording Parameters...</strong> option. The following 
dialog box appears:
</p>

<p>
<center><img src="vrrecpar.gif"></center>
</p>

<p>
Check the <strong>Record to VRML</strong> checkbox. Leave the <strong>File:</strong> editbox at its default 
value. Select the <strong>Scheduled</strong> Recording mode and specify the <strong>time period</strong> 
for which you want to record the offline animation time. Here we record the animation during the entire 
simulation time defined for this model, you may select any time interval between the Simulink model 
Start time and Stop time. For details on recording parameters please refer to the toolbox documentation. 
</p>

<p>
Once you define these animation recording parameters, animation file is created automatically when you start
the simulation. Unlike with creating the <strong>2D animation files</strong>, the internal viewer figure 
can be minimized during simulation, which significantly speeds up the simulation. At the end of simulation run, 
the created VRML animation file <code>octavia_scene_anim_1.wrl</code> remains in the working directory 
for later use.
</p>

<p>
<strong>If you distribute animation files, make sure to also distribute all the inlined
object and texture files referenced in the original VRML world file.</strong>
</p>

<p>
In the case of this demonstration example, the following files must be distributed together with the resulting 
animation file <code>octavia_scene_anim_1.wrl</code> :
</p>

<code>
<ul>
 <li>octavia_body.wrl
 <li>octavia_road.wrl 
 <li>/texture/octavia_*.jpg
</ul>
</code>

<p>
As the VRML animation file is created by default (shown in the picture above) into the current working 
directory, and not the Virtual Reality Toolbox demos directory, you will need to copy all these files
to the current working directory to view the off-line animation file correctly.
</p>

<p>
<strong>Viewing VRML off-line animation file:</strong><br><br>
You can view the resulting VRML animation file using either <strong>blaxxun Contact</strong> or 
any other generally available VRML97 viewer, or using Virtual Reality Toolbox <strong>Internal Viewer</strong>.
When using the internal viewer, it is necessary to set the virtual world <code>TimeSource</code> 
property to <code>freerun</code> to be able to see the animation. Let's assume that you want to view the 
<code>octavia_scene_anim_1.wrl</code> file that is in your current working directory. 
You can display this animated file using the following commands issued at the MATLAB command window:
</p>

<code>
&nbsp;&nbsp;&nbsp;&nbsp;w=vrview('octavia_scene_anim_1.wrl');<br>
&nbsp;&nbsp;&nbsp;&nbsp;set(w, 'TimeSource', 'freerun');
</code>

<br><br><br><br>

<p>
<em>
Skoda Octavia model copyright Skoda Auto, courtesy of Ismar VR, Czech Republic.<br>
Road geometry and simulation data generated using veDYNA by TESIS DYNAware, Germany.
</em>
</p>

</body>
</html>
